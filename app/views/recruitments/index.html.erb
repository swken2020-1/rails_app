<%= stylesheet_link_tag "/assets/recruitments.css" %>
<h1>募集一覧</h1>
<div class="fixed-top">
    <div class="float-right">
    <%= link_to "ログアウト", logout_path, method: :delete, class: "btn btn-danger" %>
    </div>
</div>
<%= link_to "Apexフレンドを募集する！", new_recruitment_path %>
<h3>検索</h3>

<%= form_with url: recruitments_search_path, method: :get, local: true do |f| %>
    <%= f.label :mode, 'モード' %>
    <%= f.select :mode,  [["ランクマッチ","ランクマッチ"],["カジュアル","カジュアル"],["イベント","イベント"],["指定無し","指定無し"]] %>
    <%= f.label :want_chara, '使いたいキャラ' %>
    <%= f.select :want_chara,  [["レイス","レイス"], ["パスファインダー","パスファインダー"], ["オクタン", "オクタン"], ["ミラージュ", "ミラージュ"], 
    ["バンガロール","バンガロール"], ["ジブラルタル", "ジブラルタル"], ["ローバ", "ローバ"], ["レブナント", "レブナント"], ["ライフライン", "ライフライン"],
    ["コースティック", "コースティック"], ["ホライゾン", "ホライゾン"],["ブラッドハウンド", "ブラッドハウンド"], ["クリプト", "クリプト"], 
    ["ランパート", "ランパート"], ["ワットソン", "ワットソン"],["誰でも","誰でも"]] %><br>
    <%= f.submit '検索', class: "btn btn-primary" %>
<% end %>
    
<table class="table table-bordered">
  <thead>
    <tr>
      <th scope="col">投稿ユーザー</th>
      <th scope="col">DiscordID</th>
      <th scope="col">モード</th>
      <th scope="col">要求ランク</th>
      <th scope="col">Use Legend</th>
      <th scope="col">Want Legend</th>
      <th scope="col">Play Style</th>
      <th scope="col">募集状況</th>
      <th scope="col"></th>
      <th scope="col"></th>
      <th scope="col"></th>
      <th scope="col"></th>
    </tr>
  </thead>
 </table>
<% @recruitments.each do |recruitment| %>
  <table class="table table-bordered">
  <tbody>
    <tr>
      <th scope="row"><%= link_to "#{User.find_by(id: recruitment.user_id).name}", "/users/#{recruitment.user_id}", method: :get %></th>
      <td><%= "#{User.find_by(id: recruitment.user_id).discord_id}" %></td>
      <td><%= recruitment.mode %></td>
      <td><%= recruitment.rank %></td>
      <td><%= recruitment.use_chara %></td>
      <td><%= recruitment.need_chara %></td>
      <td><%= recruitment.play_style %></td>
      <td><%= recruitment.flag==0? "募集中" : "募集終了" %></td>
      <td><%= link_to "詳細", "/recruitments/#{recruitment.id}" %></td>
      <td>
      <% if recruitment.user_id == session[:user_id]  %> 
      <%= link_to '削除', "/recruitments/#{recruitment.id}", method: :delete %>
      <% else %>
      <% end %> 
      </td>
      <td>
      <% if recruitment.user_id == session[:user_id] && recruitment.flag ==0  %> 
           <%= form_with model: recruitment do |f| %>
               <%= f.label :flag, "募集状況" %>
               <%= f.check_box :flag %>
               <%= f.submit "更新"  %>
           <% end %>
      <% else %>
      <% end %>
      </td>
      <td><%= link_to image_tag('/assets/twitter.png', :class => "add_style"), "https://twitter.com/share?url=Apex一緒にやる人募集中！", title: 'タイトル', target: '_blank', class: 'add_style' %></td>
    </tr>
   
  </tbody>
  </table>
<% end %>
<%= link_to_prev_page @recruitments, '前のページ', class: "prev" %>
<%= link_to_next_page @recruitments, '次のページ', class: "next" %>
