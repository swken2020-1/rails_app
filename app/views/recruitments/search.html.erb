<%= stylesheet_link_tag "/assets/recruitments.css" %>
<h1>検索結果</h1>
<table class="table table-bordered">
  <thead>
    <tr>
      <th scope="col">投稿ユーザー</th>
      <th scope="col">DiscordID</th>
      <th scope="col">モード</th>
      <th scope="col">要求ランク</th>
      <th scope="col">Use Legend</th>
      <th scope="col">Want Legend</th>
      <th scope="col">Play Style</th>
      <th scope="col">募集状況</th>
      <th scope="col"></th>
    </tr>
  </thead>
 </table>
<% @recruitments.each do |recruitment| %>
<table class="table table-bordered">
  <tbody>
    <tr>
      <th scope="row"><%= link_to "#{User.find_by(id: recruitment.user_id).name}", "/users/#{recruitment.user_id}", method: :get %></th>
      <td><%= "#{User.find_by(id: recruitment.user_id).discord_id}" %></td>
      <td><%= recruitment.mode %></td>
      <td><%= recruitment.rank %></td>
      <td><%= recruitment.use_chara %></td>
      <td><%= recruitment.need_chara %></td>
      <td><%= recruitment.play_style %></td>
      <td><% if recruitment.flag == 0 %>
            <%= link_to "募集中","/recruitments/#{recruitment.id}" %>
          <% else %>
            <%= link_to "募集終了","/recruitments/#{recruitment.id}" %>
          <% end %>
      </td>
      <td>
      <% if recruitment.user_id == session[:user_id]  %> 
      <%= link_to '削除', "/recruitments/#{recruitment.id}", method: :delete %>
      <% else %>
      <% end %> 
      </td>
      <% if recruitment.user_id == session[:user_id] && recruitment.flag ==0  %> 
           <%= form_with model: recruitment do |f| %>
               <%= f.label :flag, "募集状況" %>
               <%= f.check_box :flag %>
               <%= f.submit "更新"  %>
           <% end %>
      <% else %>
      <% end %>
      </td>
    </tr>
   
  </tbody>
  </table>
<% end %>

<%= link_to "トップに戻る", recruitments_path, {class: "btn btn-outline-secondary"} %>